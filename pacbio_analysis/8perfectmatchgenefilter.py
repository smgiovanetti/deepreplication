#!/usr/bin/env python3
import pandas as pd

df = pd.read_csv('icrgenes/rad14neg_gene.csv')

#correct sequence
sequence_to_search = "AACATAGCTGGTTCAAGACAAACCTGAGCACTTTTCATCACTGAAATCTTCACTCTGGACCAATCAACATTCATACATTCCCTTCTTTACTTTAACACTCTCCTGAGAGCTATTTCTCTTCTCATCCTAATTCTCTGCTCATATCACATTTCAGCAGCTTACATATGAAAATCTTGTACATTCCCATGAGATTGCATTGAAATTGCTTCAACCCTTTTCTATGTCCATATGTATACCTTACTTCTCATTCCTATTGCTTTGTAGCTACAGAAGCCTTAGCAGTCTTTAGAAATCTTGGGAGTGTTATGCCTCTTCCACTTAAAGCTTTAATTCAAGAACTCATTCTCTAGAAGTTTAAACAACTGCTATTCTGCTCTTCTATGACTCTTTAACATGTCTCTCAAAATATGTTTTCTCCCAGAAAACTCTCCTCAACTTTCTTCAAAATTAATAGACTACATTTTGCCCCACAGAAATTCTTCTATAGGAACTTCAATTTTTTTATTTAATCCAGGAAAACATATTTAAACATACTTAGCTATAAATATTAAGATTAAATTGTGATAAAAACTTATTTTTGACAGTGGTGGAAACTGTCCTATTAAATTTACCATATCATTCCAATTTTATCCTCAGAAAATGCCCAATAGATGATCAATAAATATTTGCAGTATACTTATTGCATTCCCAGCTATAGCTAATATAGATTGCATTAAGACTGTCTTAGGGTAGACAATAGTCAAACAGAATTGGATAGGGCATATTCAAATTCTGTAGCTACCAAATGTGTATACAAGGGAAAAATGTGTAAATGAATACTTACATAGAAAGAGCAGGACTGGTGATAAGATTGTCATGTAAATAAGTTGGTGGAGACTGTAGATTACATTGCAGAGGAATAAAGAGAACTTTTAATTTAAGAGAATCAGTCCTATGAAGAAAACAAAGACAGCAAACTACACTTCAGTCATTCCTCTCATGAGGCTCTACAGATTTTGAAAATGAGCATGGGAAAGCCCTTAGAAAATGAGCATGGGAAAGCCCTTAGAAAGAGTGATGAGGATTTTCTGAGCAATTTTGCTAAGATGCCTGATAGTAGAACAAGGGAAAGAAAAAGTTGTTAATTAAGTTTAACAGGAGAAGCTGGATTCCACCTGCAACTAGGTGGGAAAGAGTTACAAAAGGCCCCATGTAGCTACAAGTAATACATAACAAAAAGTCCCCAGGGGAACGAGGTCCTGTGTTAATCTACTATGGGCTTTAAGAGAAGAAAAACAAAAAAGGACTAAGACTCCTGAAGGAAATCATGTGAGAGCTTCCTTATTCCAGCAAGAGACAAAATCTCCATGGAAACTTCTCTTTCCTGCACCCACACACTGTTCTTTCTACCTGCCAAGGCTGCCTTGAATCTCAAGAGAATCCTATGGAGCAGTCAACACATTTTAAATACTGAAACAAACCCTAGGGAAGAAAAGAAGCAGAGCAGGCTGACATTCCAGCATTATCAGGAAAGCAATGATTTTCCTAGATTTCCGCAGC"

df = df.dropna(subset=['gene'])
matching_df = df[df['gene'].str.contains(sequence_to_search, case=False)]
matching_df = matching_df[['gene', 'frequency', 'barcode', 'classification_sequence', 'classification', 'barcode_length']]
matching_df.to_csv('rad14negshort_correctseq.csv', index=False)

non_matching_df = df[~df['gene'].str.contains(sequence_to_search, case=False)]
non_matching_df = non_matching_df[['gene', 'frequency', 'barcode', 'classification_sequence', 'classification', 'barcode_length']]
non_matching_df.to_csv('rad14negshort_incorrectseq.csv', index=False)
